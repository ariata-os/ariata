# Mac Source Configuration
# Desktop application and activity tracking from macOS

name: mac
display_name: Mac
icon: ri:mac-line
video: mac2.webm
platform: device
company: apple
description: Application usage and activity from your Mac

# Authentication
auth:
  type: device_token
  required_fields:
    - device_id
    - device_name
    - os_version
  device_setup:
    title: "Install Mac Monitor"
    download_url: "https://github.com/ariata-os/ariata/releases/latest/download/install.sh"
    install_command: "curl -sSL https://github.com/ariata-os/ariata/releases/latest/download/install.sh | bash"
    setup_steps:
      - step: "install"
        label: "Install the Mac CLI tool"
        command: "curl -sSL https://github.com/ariata-os/ariata/releases/latest/download/install.sh | bash"
      - step: "init"
        label: "Initialize with your token"
        command: "ariata-mac init {TOKEN}"
      - step: "daemon"
        label: "Start monitoring (runs in background)"
        command: "ariata-mac daemon"
    show_token_inline: true

# Available streams
streams:
  - name: apps
    display_name: Application Activity
    description: Track which applications are in focus and for how long
  - name: messages
    display_name: Messages
    description: iMessage and SMS conversation history

# Device requirements
requirements:
  min_os_version: "11.0"  # macOS Big Sur
  capabilities:
    - accessibility_api
    - screen_recording  # Optional for enhanced tracking
    - full_disk_access  # Required for Messages database
  permissions:
    - accessibility
    - automation
    - full_disk_access  # For reading ~/Library/Messages/chat.db

# Agent configuration
agent:
  type: background_service
  launch_at_login: true
  update_channel: stable
  
# Sync settings
sync:
  batch_upload_interval: 300  # 5 minutes
  max_batch_size: 500
  compression: gzip
  local_buffer:
    max_size_mb: 100
    retention_days: 7
  retry_policy:
    max_retries: 5
    backoff_multiplier: 2

# Monitoring settings
monitoring:
  heartbeat_interval: 60  # 1 minute
  crash_recovery: true
  auto_restart: true